# Описание компонентов платформы взаимодействия с ИНС

Взаимодействие пользователя с ИНС осуществляется на базе единой платформы. Платформа взаимодействия с ИНС организована с помощью ряда увязанных между собой компонент. Список компонент включает в себя:
1. Пользовательский интерфейс
2. База данных PostgreSQL v.16 
3. Апи взаимодействия с базой данных
4. Апи взаимодействия с контейнеризатором Docker
5. pgAdmin - инструмент управления и разработки для баз данных PostgreSQL


# Описание образов компонентов в рамках контейнеризатора Docker

Взаимодействие компонент организованно на базе контейнеризатора Docker. Для успешного функционирования в Docker загружены образы соответствующих компонент. Согласно общей архитектуре работы на платформе Docker, образы являются основой для формирования рабочих контейнеров.

## получение списка образов 

Для получения списка образов выполните в командной строке следующую команду:
sudo docker images 

## Перечень образов

Список образов загруженых в Docker включает в себя:
1. yiisoftware/yii2-php:8.3-apache;
2. camino-camino-plugins;
3. postgres:16.1;
4. yiisoftware/yii2-php:8.3-apache (camino-restapi-img);
5. idockerapi;
6. elestio/pgadmin;
7. prom/node-exporter.

# Создание и запуск контейнеров из образов и формирование платформы взаимодействия с ИНС 
Для создания и запуска контейнеров из загруженных образов в среде Docker, используются настроечные файлы конфигураций - docker-composer файлы с расширением yaml (см. Приложение 1). В нашем проекте сконфигурирован файл "docker-compose.yaml" в котором описывается, как запустить несколько Docker-контейнеров вместе как единое приложение. Данный файл используется инструментом docker-compose из состава платформы Docker, который позволяет запускать все контейнеры, сети, тома и настройки одной командой. Данное решение имеет следующие преимущества:
1. Автоматизирует запуск нескольких сервисов (backend, frontend, БД, мониторинг);
2. Упрощает настройку окружения;
3. Позволяет быстро разворачивать проект одной командой.

## Запуск docker-compose.yaml
Запуск docker-compose.yaml осуществляется из директории содержащей файл "docker-compose.yaml", следующей командой:
sudo docker compose up -d

После запуска команды произойдет создание контейнеров из образов. По окончании вы можете проверить работоспособность контейнеров.

# Проверка работоспособности компонентов
Для проверки работоспособности компонентов выполните в командной строке следующую команду:
sudo docker ps
Результатом будет список запущенных контейнеров, с указанием их названия, id, названия образа из которого он запущен, даты создания, портов подключения.
Список запущенных контейнеров включает в себя:
1. camino-front
2. camino-plugins
3. camino-pgdb
4. camino-restapi
5. camino-back
6. camino-pgadmin
7. node-exporter

Для более подробного изучения конфигурации контейнера используйте команду:
sudo docker inspect <container-name>

После запуска контейнеров, проверим основные компоненты обеспечивающие работоспособность платформы взаимодействия с ИНС.
Проверим состояние базы данных. Согласно настроек в базовом файле "docker-compose.yaml" (см. Приложение 1) просмотр базы данных возможен через запущенный контейнер "camino-pgadmin"
Откройте в браузере адрес http://127.0.0.1:8082/
Введите логин пароль, вы их можете видеть в "docker-compose.yaml" в разделе настроек в блоке "pgadmin4":
PGADMIN_DEFAULT_EMAIL: ******
PGADMIN_DEFAULT_PASSWORD: ******

На начальной странице pgAdmin вы можете настроить подключение к базе данных, нажав кнопку "Add New Server"

Для дальнейшей настройки сервера потребуется файл "docker-compose.yaml". В разделе настроек в блоке "postgres" найдите соотвествующие значения для парметров подключения в блоке "environment":
POSTGRES_DB: ******
POSTGRES_USER: ******
POSTGRES_PASSWORD: ******

На начальной странице pgAdmin нажмите "создать новый сервер". Укажите следующие параметры подключения:
General: 
	name: camino-pgdb
Connection: 
	Host name/address: camino-pgdb
	Port: 5432
	Maintenance database: введите значение парметра POSTGRES_DB
	Username: введите значение парметра POSTGRES_USER
	Password: введите значение парметра POSTGRES_PASSWORD

После нажатия кнопки "Save", произойдет подключение к базе данных и вы получите доступ к ее структуре и данным. В левом окне появится ее иерархическое представление в виде дерева сущностей.

Проверка работоспособности базы данных и инструметов работы с ней завершена.

Проверим соединение с пользовательским интерфейсом. Откройте в браузере адрес http://127.0.0.1:8082/
В случае корректного запуска контейнера должна отобразиться следующая форма авторизации:


На этом тестирование основных компонентов обеспечивающих работоспособность платформы взаимодействия с ИНС окончено.